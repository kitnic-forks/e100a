Version 4
SHEET 1 2864 776
WIRE -320 -800 -464 -800
WIRE -224 -800 -320 -800
WIRE -80 -800 -224 -800
WIRE -16 -800 -80 -800
WIRE 688 -800 -16 -800
WIRE 960 -800 688 -800
WIRE 1328 -800 960 -800
WIRE 1728 -800 1328 -800
WIRE -80 -752 -80 -800
WIRE -16 -752 -16 -800
WIRE -320 -720 -320 -800
WIRE -464 -704 -464 -800
WIRE -80 -672 -80 -688
WIRE -16 -672 -16 -688
WIRE -16 -672 -80 -672
WIRE 80 -672 -16 -672
WIRE 624 -672 80 -672
WIRE 800 -672 624 -672
WIRE 1264 -672 800 -672
WIRE 1664 -672 1264 -672
WIRE 736 -624 688 -624
WIRE -80 -592 -80 -672
WIRE 688 -544 688 -624
WIRE 800 -544 800 -576
WIRE 816 -544 800 -544
WIRE 912 -544 896 -544
WIRE 912 -512 912 -544
WIRE 912 -512 720 -512
WIRE 1168 -512 912 -512
WIRE 2144 -512 1168 -512
WIRE 2416 -512 2224 -512
WIRE -464 -480 -464 -624
WIRE -320 -480 -320 -656
WIRE -320 -480 -464 -480
WIRE -80 -480 -80 -512
WIRE -80 -480 -320 -480
WIRE 1552 -464 1264 -464
WIRE 2000 -464 1552 -464
WIRE 2224 -464 2000 -464
WIRE 2320 -464 2304 -464
WIRE 2496 -464 2320 -464
WIRE -464 -432 -464 -480
WIRE -464 -432 -480 -432
WIRE -320 -432 -464 -432
WIRE -240 -432 -320 -432
WIRE 64 -432 -240 -432
WIRE 448 -432 64 -432
WIRE 576 -432 448 -432
WIRE 640 -432 576 -432
WIRE 688 -432 688 -464
WIRE 688 -432 640 -432
WIRE 2112 -432 688 -432
WIRE 960 -416 960 -800
WIRE 960 -416 896 -416
WIRE 1024 -416 960 -416
WIRE 1168 -416 1024 -416
WIRE 448 -400 448 -432
WIRE 64 -352 64 -432
WIRE 112 -352 64 -352
WIRE 192 -352 112 -352
WIRE 304 -352 192 -352
WIRE 384 -352 304 -352
WIRE 1168 -352 1168 -416
WIRE 2320 -352 2320 -464
WIRE 192 -336 192 -352
WIRE 384 -320 384 -352
WIRE 896 -304 896 -320
WIRE 960 -304 960 -368
WIRE 960 -304 896 -304
WIRE 1024 -304 1024 -320
WIRE 1104 -304 1024 -304
WIRE -320 -288 -320 -432
WIRE 576 -288 576 -432
WIRE 64 -256 64 -352
WIRE 192 -240 192 -256
WIRE 304 -240 304 -272
WIRE 304 -240 192 -240
WIRE 384 -240 384 -256
WIRE 384 -240 304 -240
WIRE 512 -240 384 -240
WIRE 192 -224 192 -240
WIRE 1024 -224 1024 -304
WIRE 112 -208 112 -352
WIRE 576 -176 576 -192
WIRE 640 -176 576 -176
WIRE 720 -176 720 -512
WIRE 768 -176 720 -176
WIRE 832 -176 768 -176
WIRE 1120 -176 1088 -176
WIRE 1136 -176 1120 -176
WIRE 1264 -176 1264 -464
WIRE 1264 -176 1136 -176
WIRE 64 -160 64 -192
WIRE -464 -144 -464 -432
WIRE 448 -128 448 -304
WIRE 672 -128 448 -128
WIRE 192 -112 192 -144
WIRE 448 -112 448 -128
WIRE 576 -112 576 -176
WIRE 896 -112 896 -128
WIRE 960 -112 896 -112
WIRE 1024 -112 1024 -128
WIRE 1024 -112 960 -112
WIRE 1056 -112 1024 -112
WIRE 1136 -112 1136 -176
WIRE 1136 -112 1120 -112
WIRE 1728 -96 1728 -624
WIRE 1728 -96 1664 -96
WIRE 1824 -96 1728 -96
WIRE 768 -64 768 -176
WIRE 1168 -64 1168 -256
WIRE 1168 -64 912 -64
WIRE 1664 -64 1664 -96
WIRE 1824 -64 1824 -96
WIRE -464 -32 -464 -64
WIRE -240 -16 -240 -432
WIRE 16 -16 -240 -16
WIRE 64 -16 64 -96
WIRE 112 -16 112 -144
WIRE 112 -16 64 -16
WIRE 192 -16 192 -32
WIRE 192 -16 112 -16
WIRE 1600 -16 1488 -16
WIRE 1904 -16 1888 -16
WIRE 16 0 16 -16
WIRE 2000 0 2000 -464
WIRE 768 16 768 -64
WIRE 848 16 848 -64
WIRE 848 16 832 16
WIRE 960 16 960 -112
WIRE 1328 16 1328 -624
WIRE 1664 48 1664 32
WIRE 1936 48 1664 48
WIRE 896 64 880 64
WIRE 2416 64 2416 -512
WIRE 2496 64 2496 -464
WIRE 880 80 880 64
WIRE 880 80 16 80
WIRE 1664 80 1664 48
WIRE -240 96 -240 -16
WIRE -112 96 -240 96
WIRE 16 112 16 80
WIRE 192 112 192 64
WIRE 1328 112 1328 96
WIRE 1456 112 1328 112
WIRE -240 160 -240 96
WIRE 1760 160 1664 160
WIRE 1824 160 1824 32
WIRE 1824 160 1760 160
WIRE 2000 160 2000 96
WIRE 2000 160 1824 160
WIRE 2112 176 2112 -432
WIRE 2208 176 2112 176
WIRE 2320 176 2288 176
WIRE 2416 176 2416 64
WIRE 2416 176 2320 176
WIRE -112 192 -112 96
WIRE 192 192 16 192
WIRE 448 192 448 -32
WIRE 448 192 192 192
WIRE 576 192 576 -32
WIRE 576 192 448 192
WIRE 640 192 576 192
WIRE 960 192 640 192
WIRE 1456 208 1456 192
WIRE 1488 208 1488 -16
WIRE 1488 208 1456 208
WIRE 1584 208 1488 208
WIRE 2112 208 2112 176
WIRE 2320 208 2320 176
WIRE 2416 208 2416 176
WIRE 672 224 672 -128
WIRE 688 224 672 224
WIRE 1264 224 1264 -176
WIRE 1264 224 768 224
WIRE 1456 224 1456 208
WIRE 1584 240 1584 208
WIRE 16 256 16 192
WIRE -112 304 -112 256
WIRE -48 304 -112 304
WIRE 1168 304 1168 -64
WIRE -112 320 -112 304
WIRE 1328 336 1328 192
WIRE 1328 336 1264 336
WIRE 1456 336 1456 304
WIRE 1456 336 1328 336
WIRE 1472 336 1456 336
WIRE 1584 336 1584 304
WIRE 1584 336 1472 336
WIRE 1648 336 1584 336
WIRE 1904 336 1904 -16
WIRE 1904 336 1728 336
WIRE 2112 336 2112 272
WIRE 2112 336 1904 336
WIRE 2208 336 2112 336
WIRE 2320 336 2320 272
WIRE 2320 336 2288 336
WIRE 2416 336 2416 288
WIRE 2416 336 2320 336
WIRE 2496 336 2496 64
WIRE 2496 336 2416 336
WIRE 1264 352 1264 336
WIRE -240 368 -240 240
WIRE -176 368 -240 368
WIRE -240 384 -240 368
WIRE 1168 400 1168 384
WIRE 1200 400 1168 400
WIRE 1472 400 1472 336
WIRE -112 432 -112 416
WIRE -112 432 -176 432
WIRE -112 448 -112 432
WIRE 1312 448 1264 448
WIRE 1408 448 1392 448
WIRE 1168 464 1168 400
WIRE 1264 464 1264 448
WIRE -464 544 -464 48
WIRE -320 544 -320 -224
WIRE -320 544 -464 544
WIRE -240 544 -240 480
WIRE -240 544 -320 544
WIRE -112 544 -112 528
WIRE -112 544 -240 544
WIRE 16 544 16 352
WIRE 16 544 -112 544
WIRE 640 544 16 544
WIRE 1168 544 640 544
WIRE 1264 544 1168 544
WIRE 1472 544 1472 496
WIRE 1472 544 1264 544
FLAG -480 -432 0
FLAG 2320 -272 VEE
FLAG 640 192 VEE
FLAG 640 -432 V+
FLAG 640 544 V-
FLAG 1168 -512 FB-
FLAG 1552 -464 FB+
FLAG -224 -800 VCC
FLAG 80 -672 VBIAS
FLAG 1760 160 VEE
FLAG 2416 64 SENSE+
FLAG 2496 64 SENSE-
FLAG 1120 -176 fbin
SYMBOL zener 80 -192 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName DZ2
SYMATTR Value BZX84C6V2L
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL diode 80 -160 M0
SYMATTR InstName D3
SYMATTR Value 4148
SYMBOL cap 96 -208 R0
SYMATTR InstName C3
SYMATTR Value 47µ
SYMATTR SpiceLine V=10 Rser=7.9
SYMBOL res 176 -352 R0
SYMATTR InstName RV2A
SYMATTR Value {VPOT}
SYMATTR SpiceLine tol=10 pwr=.1
SYMBOL res 176 -240 R0
SYMATTR InstName RV2B
SYMATTR Value {10k-VPOT}
SYMATTR SpiceLine tol=10 pwr=.1
SYMBOL res 176 -128 R0
SYMATTR InstName RV1
SYMATTR Value {VTRIM}
SYMATTR SpiceLine tol=10 pwr=.1
SYMBOL cap 368 -320 R0
SYMATTR InstName C4
SYMATTR Value 1µ
SYMBOL npn 384 -400 R0
SYMATTR InstName Q4A
SYMATTR Value QPMP4201Y
SYMBOL res 432 -128 R0
SYMATTR InstName R5
SYMATTR Value 62k
SYMATTR SpiceLine tol=5 pwr=.25
SYMBOL npn 512 -288 R0
SYMATTR InstName Q4B
SYMATTR Value QPMP4201Y
SYMBOL res 560 -128 R0
SYMATTR InstName R6
SYMATTR Value 56k
SYMATTR SpiceLine tol=5 pwr=.25
SYMBOL res 176 -32 R0
SYMATTR InstName R3
SYMATTR Value 2k2
SYMATTR SpiceLine tol=5 pwr=.125
SYMBOL res 176 96 R0
SYMATTR InstName R4
SYMATTR Value 2k2
SYMATTR SpiceLine tol=5 pwr=.125
SYMBOL pnp -48 352 M180
WINDOW 0 84 60 Left 2
WINDOW 3 86 28 Left 2
SYMATTR InstName Q3
SYMATTR Value PZT2907A
SYMBOL diode -96 256 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName DZ1
SYMATTR Value BZX84-B33
SYMBOL npn -176 320 R0
SYMATTR InstName Q2
SYMATTR Value 3904
SYMBOL res -128 432 R0
SYMATTR InstName R2
SYMATTR Value 330
SYMATTR SpiceLine tol=5 pwr=0.125
SYMBOL npn -176 384 M0
SYMATTR InstName Q1
SYMATTR Value 3904
SYMBOL res -256 144 R0
SYMATTR InstName R1
SYMATTR Value 10k
SYMATTR SpiceLine tol=5 pwr=0.125
SYMBOL voltage -464 -160 M0
WINDOW 123 24 44 Left 2
WINDOW 39 24 72 Left 2
SYMATTR SpiceLine Rser=0.2
SYMATTR InstName V1
SYMATTR Value 40
SYMBOL cap -336 -288 R0
SYMATTR InstName C2
SYMATTR Value 1000µ
SYMATTR SpiceLine V=63 Rser=0.13
SYMBOL res 736 -192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 22k
SYMATTR SpiceLine tol=0.5 pwr=0.1
SYMBOL npn 832 -224 R0
SYMATTR InstName Q5A
SYMATTR Value QPMP4201Y
SYMBOL npn 1088 -224 M0
WINDOW 3 56 68 Invisible 2
SYMATTR Value QPMP4201Y
SYMATTR InstName Q5B
SYMBOL npn 896 16 R0
SYMATTR InstName Q6
SYMATTR Value 3904
SYMBOL res 944 96 R0
SYMATTR InstName R12
SYMATTR Value 1k
SYMATTR SpiceLine tol=5 pwr=0.125
SYMBOL res 0 96 R0
SYMATTR InstName R10
SYMATTR Value 2k2
SYMBOL res 0 -16 R0
SYMATTR InstName R11
SYMATTR Value 22k
SYMBOL diode 1056 -96 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D4
SYMATTR Value 4148
SYMBOL pnp 1104 -256 M180
SYMATTR InstName Q7
SYMATTR Value 2N2907
SYMBOL npn 1200 352 R0
WINDOW 3 54 59 Left 2
SYMATTR Value PZT2222A
SYMATTR InstName Q8
SYMBOL res 1184 448 M0
SYMATTR InstName R15
SYMATTR Value 10k
SYMBOL npn 1408 400 R0
SYMATTR InstName Q9
SYMATTR Value QD44H11
SYMBOL res 1408 432 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RQ9B
SYMATTR Value 100
SYMBOL res 1744 320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value 1
SYMATTR SpiceLine tol=1 pwr=0.5
SYMBOL cap 2096 208 R0
SYMATTR InstName C8
SYMATTR Value 47µ
SYMATTR SpiceLine V=50 Rser=2.82
SYMBOL ind2 2192 192 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName LFPA
SYMATTR Value 0.5µ
SYMATTR Type ind
SYMATTR SpiceLine Rser=0.1 Rpar=100
SYMBOL ind2 2192 320 M90
WINDOW 0 5 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName LFPB
SYMATTR Value 0.5µ
SYMATTR Type ind
SYMATTR SpiceLine Rser=0.1 Rpar=100
SYMBOL cap 2304 208 R0
SYMATTR InstName CFP
SYMATTR Value 100n
SYMATTR SpiceLine V=200
SYMBOL res 2400 192 R0
SYMATTR InstName RLOAD
SYMATTR Value 1k
SYMBOL res 2320 -480 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 120k
SYMATTR SpiceLine tol=0.5 pwr=0.1
SYMBOL res 784 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 22k
SYMATTR SpiceLine tol=0.5 pwr=0.1
SYMBOL res 2240 -528 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R22
SYMATTR Value 120k
SYMATTR SpiceLine tol=0.5 pwr=0.1
SYMBOL res 2304 -368 R0
SYMATTR InstName R24
SYMATTR Value 120k
SYMBOL voltage -464 -720 R0
WINDOW 123 24 44 Left 2
WINDOW 39 24 72 Left 2
SYMATTR SpiceLine Rser=1
SYMATTR InstName V2
SYMATTR Value 3.5
SYMBOL cap -336 -720 R0
SYMATTR InstName C1
SYMATTR Value 470µ
SYMATTR SpiceLine V=10 Rser=0.68
SYMBOL diode -64 -688 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName DZ3
SYMATTR Value BZX84-C2V4
SYMBOL res -64 -608 M0
SYMATTR InstName R17
SYMATTR Value 390
SYMATTR SpiceLine tol=5 pwr=.125
SYMBOL cap -32 -752 R0
SYMATTR InstName C6
SYMATTR Value 47µ
SYMATTR SpiceLine V=10 Rser=7.9
SYMBOL pnp 1264 -624 M180
SYMATTR InstName Q10
SYMATTR Value 3906
SYMBOL res 1312 -816 R0
SYMATTR InstName R18
SYMATTR Value 3k3
SYMATTR SpiceLine tol=5 pwr=.125
SYMBOL res 1312 96 R0
SYMATTR InstName RV3B
SYMATTR Value {ITRIM}
SYMBOL res 1312 0 R0
SYMATTR InstName RV3A
SYMATTR Value {2k-ITRIM}
SYMBOL res 1440 96 R0
WINDOW 0 69 42 Left 2
WINDOW 3 63 76 Left 2
SYMATTR InstName RV4A
SYMATTR Value {10k-IPOT}
SYMBOL res 1440 208 R0
SYMATTR InstName RV4B
SYMATTR Value {IPOT}
SYMBOL cap 1568 240 R0
SYMATTR InstName C7
SYMATTR Value 10n
SYMATTR SpiceLine V=16
SYMBOL pnp 1600 32 M180
SYMATTR InstName Q12A
SYMATTR Value QPMP5201Y
SYMBOL pnp 1888 32 R180
WINDOW 0 65 32 Left 2
WINDOW 3 84 68 Invisible 2
SYMATTR InstName Q12B
SYMATTR Value QPMP5201Y
SYMBOL res 1648 64 R0
SYMATTR InstName R20
SYMATTR Value 2k2
SYMBOL npn 1936 0 R0
SYMATTR InstName Q13
SYMATTR Value 3904
SYMBOL pnp 1664 -624 M180
SYMATTR InstName Q11
SYMATTR Value 3906
SYMBOL res 1712 -816 R0
SYMATTR InstName R19
SYMATTR Value 820
SYMATTR SpiceLine tol=5 pwr=.125
SYMBOL pnp 624 -624 M180
SYMATTR InstName Q14
SYMATTR Value 3906
SYMBOL res 672 -816 R0
SYMATTR InstName R25
SYMATTR Value 10k
SYMBOL pnp 736 -576 M180
SYMATTR InstName Q15
SYMATTR Value 3906
SYMBOL res 704 -560 M0
SYMATTR InstName R13
SYMATTR Value 10k
SYMBOL res 1248 448 R0
SYMATTR InstName R16
SYMATTR Value 100
SYMBOL res 1184 288 M0
SYMATTR InstName R14
SYMATTR Value 1k
SYMBOL res 912 -560 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R26
SYMATTR Value 1k
SYMBOL pnp 960 -320 R180
SYMATTR InstName Q16A
SYMATTR Value QPMP5201Y
SYMBOL pnp 960 -320 M180
SYMATTR InstName Q16B
SYMATTR Value QPMP5201Y
SYMBOL res 880 -320 R0
SYMATTR InstName R9
SYMATTR Value 1k
SYMBOL res 288 -368 R0
SYMATTR InstName R29
SYMATTR Value 12k
SYMBOL cap 912 -80 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C5
SYMATTR Value 33p
SYMBOL voltage -464 -48 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V4
SYMATTR Value SINE(0 2.1 120)
SYMBOL res 864 -80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R27
SYMATTR Value 470k
SYMBOL cap 832 0 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C9
SYMATTR Value 470p
TEXT -504 600 Left 2 !.model PZT2907A ako:2N2907
TEXT -504 696 Left 2 !.model 3904 ako:2N3904
TEXT -504 728 Left 2 !.model 3906 ako:2N3906
TEXT -136 600 Left 2 !.lib BZX84-B33.prm
TEXT -136 632 Left 2 !.lib PMP4201Y.prm
TEXT 104 600 Left 2 !.param VPOT {325*V_SETPOINT}
TEXT 48 472 Left 2 !.param VTRIM 1k2
TEXT -504 760 Left 2 !.model 4148 ako:1N4148
TEXT -504 664 Left 2 !.model PZT2222A ako:2N2222
TEXT -504 632 Left 2 !.model MMBT2907A ako:2N2907
TEXT -136 696 Left 2 !.lib D44H11.LIB
TEXT 2120 400 Left 2 !K1 LFPA LFPB 1
TEXT -136 664 Left 2 !.lib PMP5201Y.prm
TEXT -136 728 Left 2 !.lib BZX84-C2V4.prm
TEXT 344 472 Left 2 !.param ITRIM 1157
TEXT 344 440 Left 2 !.param I_SETPOINT 499m
TEXT 104 632 Left 2 !.param IPOT {20k*I_SETPOINT}
TEXT 232 344 Left 2 ;SETPOINTS ARE APPROXIMATE.\nControls are not perfectly linear.
TEXT 56 400 Left 2 !.param V_SETPOINT 29.9
TEXT 680 424 Left 2 !;ac dec 100 100 100Meg
TEXT 680 456 Left 2 !.tran 1 startup
